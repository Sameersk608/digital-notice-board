<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="assets/css/teacher.css">
    <title>Document</title>
</head>
<body>
    <div id="add">
        <h1><u>Add Notification</u></h1>
        <form action="addN.php" method="post">
        <table>
            <tr>
                <th>Posted By </th>
                <th><input list="teacher" name="by" id="selT">

                    <datalist id="teacher">
                    <option value="Santosh Katti"></option>
                    <option value="Dr Lekha A"></option>
                    <option value="Tamal Dey"></option>
                    <option value="Premlatha HM"></option>
                    <option value="Thenmozhi S"></option>
                    <option value="Archana A"></option>
                    <option value="Srinivas S"></option>
                    <option value="Sujeeth"></option>
                </datalist></th>
            </tr>
            <tr>
                <th>Posted For</th>
                <th><input list="forSt" name="forSt" id="selFor">

                    <datalist id="forSt">
                    <option value="MCA 1 sem"></option>
                    <option value="MCA 2 sem"></option>
                    <option value="MCA 3 sem"></option>
                    <option value="MCA 4 sem"></option>
                </datalist></th>
            </tr>
            <tr>
                <th>Meta Info</th>
                <th><input type="text" name="meta" id=""></th>
            </tr>
            <tr>
                <th>Category</th>
                <th><input list="catsSel" name="cats" id="catts">

                    <datalist id="catsSel">
                    <option value="Placements"></option>
                    <option value="Registration"></option>
                    <option value="Exams and Practical Schedule"></option>
                    <option value="Extra Curricular Activities"></option>
                </datalist></th>
            </tr>
            <tr>
                <th>Title</th>
                <th><input type="text" name='title'></th>
            </tr>
            <tr>
                <th>Description</th>
                <th><textarea name="desc" id="" cols="30" rows="10"></textarea></th>
            </tr>
            <tr>
                <th>Links</th>
                <th><input type="text"  
                    pattern="https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)"
                    name="links" id=""></th>
            </tr>
            <tr>
                <th>Expiry</th>
                <th><input type="date" name="expiry" id="expiry" min='2021-01-01' max='2022-12-31'></th>
            </tr>
        </table>
        <button type="submit">ADD</button>
    </form>
   </div>
   <br><br><br><br><br>
    <div id="edit"style="position: relative;">
         <h1><u>Edit Notification</u></h1>
            <label for="sellab">Choose Notification ID</label>
            <div style="position:relative;float:right;" id="sellab">
                <select id="notifs">
                
            </select>
        </div>
        <table>
            <tr>
                <th>Posted By </th>
                <th><input type="text" id="editBy"></th>
            </tr>
            <tr>
                <th>Posted For</th>
                <th><input type="text" id="editFor"></th>
            </tr>
            <tr>
                <th>Meta Info</th>
                <th><input type="text" name=""  id="editMeta"></th>
            </tr>
            <tr>
                <th>Category</th>
                <th><select name="" id="editCategory">
                    <option value="">Placements</option>
                    <option>Academics</option>
                </select></th>
            </tr>
            <tr>
                <th>Title</th>
                <th><input type="text" id="editTitle"></th>
            </tr>
            <tr>
                <th>Description</th>
                <th><textarea name="" cols="30" id="editDescription" rows="10"></textarea></th>
            </tr>
            <tr>
                <th>Links</th>
                <th><input type="text" name=""  id="editLink"></th>
            </tr>
            <tr>
                <th>Expiry</th>
                <th><input type="date" name="" id="editExpiry"></th>
            </tr>
        </td>
        <td>
        </table>
   </div>
    <div id="delete">
        <h1><u>Delete Notification</u></h1>
        <div class="chips" id="cates">
            <div class="chip">BCA 1st Sem</div>
            <div class="chip">BCA 3rd Sem</div>
            <div class="chip">BCA 5th Sem</div>
            <div class="chip">MCA 1st Sem</div>
            <div class="chip">MCA 3rd Sem</div>
        </div>
        <br>
        <br>
        <table style="width:90%;">
                <tr>
                    <th style="text-align: center;" colspan="3" id="cate">BCA 1st Sem</th>
                </tr>
                <tr>
                    <th>Category</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Expiry</th>
                    <th>Delete</th>
                </tr>
        </table>
    </div>
    <div id="view">
        <h1><u>View Notification</u></h1>
    </div>
    <script>
        function writeToForm(d){
           d=d[0]
            console.log(d)
            document.getElementById('editBy').value=d['byName']
            document.getElementById('editFor').value=d['forName']
            document.getElementById('editMeta').value=d['meta']
            document.getElementById('editCategory').value=d['category']
            document.getElementById('editTitle').value=d['title']
           document.getElementById('editLink').value=d['link']
            document.getElementById('editExpiry').value=d['expiry']
            document.getElementById('editDescription').innerText=d['description']
        }

        parent=document.getElementById('cates')
        parent.addEventListener("click",(e)=>{
            appd=document.getElementById('cate')
            appd.innerText=e.target.innerText;
        })

    fetch('count.php')
    .then(res=>res.json())
    .then(d=>{
        let notifs=document.getElementById('notifs')
        for(let i=1;i<=Number(d);i++){
            let option=document.createElement('OPTION');
            option.setAttribute('value',i);
            var text = document.createTextNode(i);
            option.appendChild(text)
            notifs.appendChild(option);
        }
    })     
    
    notifs.onchange=(e)=>{
        let id = notifs.value;
        let formData = new FormData();
        formData.append('id', id);
        fetch('postIdForEdit.php',{method:"POST",body:formData})
        .then(res=>res.json())
        .then(d=>writeToForm(d))
    }
    //    document.onload=()=>{
    //     expiry=document.getElementById('expiry')
    //     expiry.min='2021-01-01'
    //     expiry.min='2024-12-31'
    //    }    
    </script>
</body>
</html>